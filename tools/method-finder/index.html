<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>UX Research Method Finder — Find the Right Research Method | Miguel Tomás Gomes</title>
  <meta name="description" content="Find the right UX research method for your project. Answer two questions to get personalized recommendations for A/B testing, usability testing, card sorting, and more with statistical guidance." />

  <!-- Open Graph / Facebook -->
  <meta property="og:type" content="website">
  <meta property="og:url" content="https://migueltomasgomes.com/tools/method-finder">
  <meta property="og:title" content="UX Research Method Finder — Find the Right Research Method">
  <meta property="og:description" content="Find the right UX research method for your project. Get personalized recommendations based on your research question and sample size.">
  <meta property="og:image" content="https://migueltomasgomes.com/assets/portrait-miguel-tomas-gomes-ux.png">

  <!-- Twitter -->
  <meta property="twitter:card" content="summary_large_image">
  <meta property="twitter:url" content="https://migueltomasgomes.com/tools/method-finder">
  <meta property="twitter:title" content="UX Research Method Finder">
  <meta property="twitter:description" content="Find the right UX research method for your project. Get personalized recommendations based on your research question and sample size.">
  <meta property="twitter:image" content="https://migueltomasgomes.com/assets/portrait-miguel-tomas-gomes-ux.png">

  <!-- Canonical URL -->
  <link rel="canonical" href="https://migueltomasgomes.com/tools/method-finder">

  <!-- Schema.org structured data -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebApplication",
    "name": "UX Method Finder",
    "alternateName": "UX Research Method Finder",
    "description": "Interactive tool to help UX designers find the right research method based on research question and sample size",
    "url": "https://migueltomasgomes.com/tools/method-finder",
    "applicationCategory": "DesignApplication",
    "operatingSystem": "Any",
    "offers": {
      "@type": "Offer",
      "price": "0",
      "priceCurrency": "USD"
    },
    "author": {
      "@type": "Person",
      "name": "Miguel Tomás Gomes",
      "url": "https://migueltomasgomes.com"
    },
    "keywords": "UX research, research methods, method finder, A/B testing, usability testing, card sorting, statistical analysis, sample size, user research"
  }
  </script>

  <link rel="icon" type="image/png" href="../../assets/favicon-miguel-tomas-gomes.png">
  <style>
    :root {
      --accent: #0052ff;
      --accent-light: #eff6ff;
      --text: #111;
      --muted: #666;
      --bg: #ffffff;
      --card: #ffffff;
      --border: #e2e8f0;
      --green: #059669;
      --green-light: #ecfdf5;
      --amber: #d97706;
      --amber-light: #fffbeb;
      --red: #dc2626;
      --red-light: #fef2f2;
    }

    * { margin: 0; padding: 0; box-sizing: border-box; }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
      background: var(--bg);
      color: var(--text);
      min-height: 100vh;
      line-height: 1.6;
    }

    a { color: var(--accent); text-decoration: none; }
    a:hover { text-decoration: underline; }

    /* ---------------  NAV (glassmorphism)  --------------- */
    header {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      background: rgba(255,255,255,.8);
      backdrop-filter: blur(10px);
      z-index: 100;
      animation: slideDown .8s both;
    }

    nav {
      max-width: 1100px;
      margin: auto;
      display: flex;
      align-items: center;
      justify-content: space-between;
      padding: 1.8rem 2.5rem;
    }

    .logo {
      font-weight: 600;
      font-size: 1rem;
      color: var(--text);
    }
    .logo:hover { text-decoration: none; }

    .nav-links {
      list-style: none;
      display: flex;
      gap: 3rem;
      margin: 0;
      padding: 0;
    }

    .nav-links li {
      opacity: 0;
      animation: fadeIn .6s forwards;
      animation-delay: calc(.1s * var(--i));
    }

    .nav-links a {
      color: var(--text);
      font-weight: 500;
      transition: color .25s;
      text-decoration: none;
    }

    .nav-links a:hover {
      color: var(--accent);
    }

    .nav-links a.active {
      color: var(--accent);
      text-decoration: underline;
      text-underline-offset: 4px;
    }

    /* Hamburger menu */
    .hamburger {
      display: none;
      flex-direction: column;
      gap: 5px;
      background: none;
      border: none;
      cursor: pointer;
      padding: 8px;
      z-index: 101;
    }
    .hamburger span {
      width: 24px;
      height: 2px;
      background: var(--text);
      transition: all 0.3s ease;
      border-radius: 2px;
    }
    .hamburger.active span:nth-child(1) {
      transform: rotate(45deg) translate(7px, 7px);
    }
    .hamburger.active span:nth-child(2) {
      opacity: 0;
    }
    .hamburger.active span:nth-child(3) {
      transform: rotate(-45deg) translate(7px, -7px);
    }

    /* Mobile responsive */
    @media (max-width: 768px) {
      .hamburger {
        display: flex;
      }
      .nav-links {
        position: fixed;
        top: 0;
        right: -100%;
        height: 100vh;
        width: 70%;
        max-width: 300px;
        background: rgba(255, 255, 255, 0.98);
        backdrop-filter: blur(20px);
        flex-direction: column;
        justify-content: center;
        align-items: center;
        gap: 2.5rem;
        transition: right 0.3s ease;
        box-shadow: -5px 0 20px rgba(0, 0, 0, 0.1);
      }
      .nav-links.active {
        right: 0;
      }
      .nav-links li {
        font-size: 1.2rem;
      }
      nav {
        padding: 1.5rem 1.5rem;
      }
      .main {
        padding: 100px 20px 60px;
      }
      .selectors {
        grid-template-columns: 1fr;
        gap: 24px;
      }
      .selector-group select {
        padding: 14px 16px;
        font-size: 1rem;
        min-height: 48px;
        -webkit-appearance: none;
        -moz-appearance: none;
      }
      .select-wrapper {
        position: relative;
        z-index: 1;
      }
      .select-wrapper select {
        position: relative;
        z-index: 2;
      }
    }

    @keyframes slideDown {
      from { transform: translateY(-100%); }
      to { transform: translateY(0); }
    }
    @keyframes fadeIn {
      to { opacity: 1; }
    }

    /* MAIN */
    .main {
      max-width: 720px;
      margin: 0 auto;
      padding: 120px 24px 80px;
    }

    /* PAGE FOOTER */
    .page-footer {
      display: flex;
      flex-wrap: wrap;
      justify-content: space-between;
      align-items: center;
      margin-top: 5px;
      padding-top: 24px;
      border-top: 1px solid var(--border);
    }
    .footer-link {
      font-size: 0.875rem;
      font-weight: 500;
      color: var(--muted);
      background: none;
      border: none;
      cursor: pointer;
      transition: color 0.2s;
      text-decoration: none;
    }
    .footer-link:hover {
      color: var(--accent);
      text-decoration: none;
    }
    .footer-note {
      text-align: center;
      font-size: 0.6875rem;
      color: var(--muted);
      opacity: 0.5;
      margin-top: 32px;
      margin-bottom: 3px;
    }
    .footer-note a {
      color: var(--muted);
      text-decoration: underline;
    }
    .footer-note a:hover {
      color: var(--accent);
      opacity: 1;
    }

    /* SELECTORS */
    .selectors {
      display: grid;
      grid-template-columns: 1fr 1fr;
      gap: 16px;
      margin-bottom: 32px;
    }

    .selector-group label {
      display: block;
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .selector-group select {
      width: 100%;
      padding: 12px 16px;
      font-size: 0.9375rem;
      font-family: inherit;
      border: 1px solid var(--border);
      border-radius: 8px;
      background: var(--card);
      color: var(--text);
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2364748b' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 12px center;
    }

    .selector-group select:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 0 3px var(--accent-light);
    }

    .hint-message {
      display: block;
      font-size: 0.8125rem;
      color: var(--accent);
      height: 1.2em;
      margin-top: 6px;
    }

    .select-wrapper {
      position: relative;
    }

    .select-wrapper.disabled::after {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      bottom: 0;
      cursor: not-allowed;
    }

    /* RECOMMENDATION CARD */
    .rec-card {
      background: var(--card);
      border: 1px solid var(--border);
      border-radius: 12px;
      padding: 32px;
      margin-bottom: 24px;
    }

    .rec-header {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .rec-badge {
      display: inline-block;
      padding: 4px 10px;
      font-size: 0.6875rem;
      font-weight: 600;
      border-radius: 4px;
      text-transform: uppercase;
      letter-spacing: 0.03em;
    }

    .rec-badge.green { background: var(--green-light); color: var(--green); }
    .rec-badge.amber { background: var(--amber-light); color: var(--amber); }
    .rec-badge.blue { background: var(--accent-light); color: var(--accent); }

    .rec-method {
      font-size: 1.25rem;
      font-weight: 700;
      color: var(--text);
    }

    .rec-desc {
      font-size: 0.9375rem;
      color: var(--muted);
      line-height: 1.6;
      margin-bottom: 24px;
    }

    /* STEPS */
    .steps-title {
      font-size: 0.75rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      margin-bottom: 12px;
    }

    .steps {
      list-style: none;
      padding: 0;
      margin: 0 0 24px 0;
    }

    .steps li {
      position: relative;
      padding-left: 24px;
      padding-bottom: 12px;
      font-size: 0.9375rem;
      line-height: 1.5;
      color: var(--text);
    }

    .steps li::before {
      content: '';
      position: absolute;
      left: 0;
      top: 6px;
      width: 8px;
      height: 8px;
      border: 2px solid var(--green);
      border-radius: 2px;
    }

    .steps li:last-child { padding-bottom: 0; }

    /* WARNING BOX */
    .warning-box {
      background: var(--amber-light);
      border-left: 3px solid var(--amber);
      padding: 16px 20px;
      border-radius: 0 8px 8px 0;
      margin-bottom: 24px;
    }

    .warning-box p {
      font-size: 0.875rem;
      line-height: 1.6;
      color: var(--text);
      margin: 0;
    }

    /* QUOTE BOX */
    .quote-box {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px 20px;
      position: relative;
    }

    .quote-label {
      font-size: 0.6875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      margin-bottom: 8px;
    }

    .quote-text {
      font-size: 0.875rem;
      line-height: 1.6;
      color: var(--text);
      font-style: italic;
    }

    /* METRICS BOX */
    .metrics-box {
      background: var(--bg);
      border: 1px solid var(--border);
      border-radius: 8px;
      padding: 16px 20px;
      margin-top: 24px;
    }
    .metrics-title {
      font-size: 0.6875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.05em;
      color: var(--muted);
      margin-bottom: 16px;
    }
    .metric-step {
      margin-bottom: 16px;
    }
    .metric-step:last-child {
      margin-bottom: 0;
    }
    .metric-step-title {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--text);
      margin-bottom: 4px;
    }
    .metric-step-title::before {
      content: counter(step) ". ";
      color: var(--accent);
    }
    .metrics-box {
      counter-reset: step;
    }
    .metric-step {
      counter-increment: step;
    }
    .metric-step-desc {
      font-size: 0.8125rem;
      color: var(--muted);
      line-height: 1.5;
    }
    .metric-step-example {
      font-size: 0.8125rem;
      color: var(--text);
      margin-top: 2px;
    }
    .metric-step-formula {
      font-size: 0.8125rem;
      color: var(--accent);
      margin-top: 4px;
      font-family: ui-monospace, SFMono-Regular, "SF Mono", Menlo, monospace;
      background: var(--card);
      padding: 6px 10px;
      border-radius: 4px;
      display: inline-block;
    }
    .metric-step-note {
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 4px;
      font-style: italic;
    }
    .metrics-table {
      margin-top: 16px;
      width: 100%;
      border-collapse: collapse;
    }
    .metrics-table-title {
      font-size: 0.75rem;
      color: var(--muted);
      margin-bottom: 8px;
    }
    .metrics-table th,
    .metrics-table td {
      font-size: 0.8125rem;
      padding: 6px 12px;
      text-align: left;
      border-bottom: 1px solid var(--border);
    }
    .metrics-table th {
      font-weight: 600;
      color: var(--muted);
    }
    .metrics-table td {
      color: var(--text);
    }
    .metrics-table tr:last-child td {
      border-bottom: none;
    }

    /* STRUCTURE BOX (qualitative methods) */
    .structure-intro {
      font-size: 0.8125rem;
      color: var(--muted);
      margin-bottom: 16px;
      font-style: italic;
    }

    /* GLOSSARY TERMS */
    .term {
      text-decoration: underline;
      text-decoration-style: dotted;
      text-decoration-color: var(--muted);
      text-underline-offset: 2px;
      cursor: help;
      position: relative;
    }

    .tooltip {
      display: none;
      position: absolute;
      bottom: calc(100% + 8px);
      left: 50%;
      transform: translateX(-50%);
      background: var(--text);
      color: white;
      padding: 12px 14px;
      border-radius: 8px;
      font-size: 0.8125rem;
      line-height: 1.5;
      width: 260px;
      z-index: 50;
      box-shadow: 0 4px 12px rgba(0,0,0,0.15);
      font-weight: normal;
      font-style: normal;
      text-decoration: none;
    }

    .tooltip::after {
      content: '';
      position: absolute;
      top: 100%;
      left: 50%;
      transform: translateX(-50%);
      border: 6px solid transparent;
      border-top-color: var(--text);
    }

    .term:hover .tooltip,
    .term:focus .tooltip {
      display: block;
    }

    .tooltip-link {
      display: block;
      margin-top: 8px;
      padding-top: 8px;
      border-top: 1px solid rgba(255,255,255,0.2);
      color: var(--accent-light);
      font-size: 0.75rem;
      cursor: pointer;
    }
    .tooltip-link:hover {
      text-decoration: underline;
    }

    /* GLOSSARY MODAL */
    .glossary-modal {
      display: none;
      position: fixed;
      inset: 0;
      background: rgba(15, 23, 42, 0.5);
      z-index: 200;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }
    .glossary-modal.active { display: flex; }

    .glossary-content {
      background: var(--card);
      border-radius: 12px;
      width: 100%;
      max-width: 560px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px -12px rgba(0,0,0,0.25);
    }

    .glossary-header {
      padding: 20px 24px;
      border-bottom: 1px solid var(--border);
      display: flex;
      justify-content: space-between;
      align-items: center;
      position: sticky;
      top: 0;
      background: var(--card);
    }

    .glossary-title {
      font-size: 1rem;
      font-weight: 700;
    }

    .glossary-body {
      padding: 24px;
    }

    .glossary-item {
      margin-bottom: 20px;
    }
    .glossary-item:last-child { margin-bottom: 0; }

    .glossary-term {
      font-weight: 600;
      font-size: 0.9375rem;
      color: var(--text);
      margin-bottom: 4px;
    }

    .glossary-def {
      font-size: 0.875rem;
      line-height: 1.6;
      color: var(--muted);
    }

    /* EMPTY STATE */
    .empty-state {
      text-align: center;
      padding: 48px 24px 40px;
      color: var(--muted);
    }

    .empty-state p {
      font-size: 0.9375rem;
      margin-top: 8px;
    }

    /* Floating icons container */
    .floating-icons {
      position: relative;
      width: 120px;
      height: 120px;
      margin: 0 auto;
    }

    /* Orbit path circle */
    .floating-icons::before {
      content: '';
      position: absolute;
      top: 50%;
      left: 50%;
      width: 110px;
      height: 110px;
      border: 1px solid rgba(107, 140, 204, 0.15);
      border-radius: 50%;
      transform: translate(-50%, -50%);
      z-index: 0;
    }

    .floating-icons svg {
      position: absolute;
      width: 40px;
      height: 40px;
      background: transparent;
      overflow: visible;
    }

    /* Center checklist - largest, focal point */
    .floating-icons .icon-checklist {
      width: 72px;
      height: 72px;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      z-index: 5;
      animation: floatCenter 3.5s ease-in-out infinite;
    }

    /* Orbit wrappers - these rotate around the center */
    .orbit-wrapper {
      position: absolute;
      width: 40px;
      height: 40px;
      top: 50%;
      left: 50%;
      margin-top: -20px;
      margin-left: -20px;
      transform-origin: 20px 20px;
    }
    .orbit-wrapper svg {
      position: relative;
      top: 0; left: 0;
      width: 40px;
      height: 40px;
    }
    .orbit-1 {
      transform: rotate(0deg) translateX(55px) rotate(0deg);
      animation: orbit 20s linear infinite;
      z-index: 2;
    }
    .orbit-2 {
      transform: rotate(90deg) translateX(55px) rotate(-90deg);
      animation: orbit 20s linear infinite;
      animation-delay: -5s;
      z-index: 3;
    }
    .orbit-3 {
      transform: rotate(180deg) translateX(55px) rotate(-180deg);
      animation: orbit 20s linear infinite;
      animation-delay: -10s;
      z-index: 1;
    }
    .orbit-4 {
      transform: rotate(270deg) translateX(55px) rotate(-270deg);
      animation: orbit 20s linear infinite;
      animation-delay: -15s;
      z-index: 4;
    }

    /* Empty state title */
    .empty-state-title {
      font-size: 1.5rem;
      font-weight: 600;
      color: var(--text);
      margin: 1.5rem 0 0.5rem 0;
      text-align: center;
    }

    /* Floating animations */
    @keyframes floatCenter {
      0%, 100% { transform: translate(-50%, -50%) scale(1); }
      50% { transform: translate(-50%, -50%) scale(1.02); }
    }
    @keyframes orbit {
      0% { transform: rotate(0deg) translateX(55px) rotate(0deg); }
      100% { transform: rotate(360deg) translateX(55px) rotate(-360deg); }
    }

  </style>
</head>
<body>
  <header>
    <nav aria-label="Primary">
      <a href="/" class="logo">Miguel Tomás Gomes</a>
      <button class="hamburger" aria-label="Toggle menu" aria-expanded="false">
        <span></span>
        <span></span>
        <span></span>
      </button>
      <ul class="nav-links" id="navMenu">
        <li style="--i:1"><a href="/">Home</a></li>
        <li style="--i:2"><a href="/about">About</a></li>
        <li style="--i:3"><a href="/articles/">Work Samples</a></li>
        <li style="--i:4"><a href="/tools/method-finder" class="active">UX Method Finder</a></li>
        <li style="--i:5"><a href="/#contact">Contact</a></li>
      </ul>
    </nav>
  </header>

  <!-- MAIN -->
  <main class="main">
    <!-- SELECTORS -->
    <div class="selectors">
      <div class="selector-group">
        <label>What's your research question?</label>
        <select id="intentSelect" onchange="updateRecommendation()">
          <option value="">Select...</option>
          <option value="clarity">Is this clear for users?</option>
          <option value="comparison">Which option do users prefer?</option>
          <option value="conversion">Which option performs better?</option>
          <option value="diagnostic">What's causing problems?</option>
          <option value="discovery">What do users need?</option>
          <option value="organization">How do users organize this?</option>
        </select>
      </div>
      <div class="selector-group">
        <label>How many available participants?</label>
        <div id="sampleSelectWrapper" class="select-wrapper disabled">
          <select id="sampleSelect" onchange="updateRecommendation()" disabled>
            <option value="">Select...</option>
          </select>
        </div>
        <span id="sampleHint" class="hint-message"></span>
      </div>
    </div>

    <!-- RECOMMENDATION -->
    <div id="recommendation">
      <div class="empty-state">
        <div class="floating-icons">
          <div class="orbit-wrapper orbit-1"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g1" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><rect fill="white" height="16" rx="3" ry="3" stroke="url(#g1)" stroke-width="2" width="6" x="10" y="22"/><rect fill="white" height="24" rx="3" ry="3" stroke="url(#g1)" stroke-width="2" width="6" x="21" y="14"/><rect fill="white" height="28" rx="3" ry="3" stroke="url(#g1)" stroke-width="2" width="6" x="32" y="10"/></svg></div>
          <div class="orbit-wrapper orbit-2"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g2" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><circle cx="24" cy="24" fill="white" r="16" stroke="url(#g2)" stroke-width="2"/><line stroke="url(#g2)" stroke-width="2" x1="24" x2="24" y1="24" y2="8"/><line stroke="url(#g2)" stroke-width="2" x1="24" x2="38" y1="24" y2="30"/></svg></div>
          <svg class="icon-checklist" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g3" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><rect fill="white" height="32" rx="4" ry="4" stroke="url(#g3)" stroke-width="1.2" width="24" x="12" y="8"/><rect fill="white" height="4" rx="1" ry="1" stroke="url(#g3)" stroke-width="1.2" width="4" x="16" y="16"/><rect fill="white" height="4" rx="1" ry="1" stroke="url(#g3)" stroke-width="1.2" width="4" x="16" y="24"/><polyline fill="none" points="22,18 24,20 28,16" stroke="url(#g3)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"/><polyline fill="none" points="22,26 24,28 28,24" stroke="url(#g3)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"/></svg>
          <div class="orbit-wrapper orbit-3"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g4" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><polyline fill="none" points="8,32 18,26 28,20 38,14" stroke="url(#g4)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/><circle cx="8" cy="32" fill="white" r="2.5" stroke="url(#g4)" stroke-width="2"/><circle cx="18" cy="26" fill="white" r="2.5" stroke="url(#g4)" stroke-width="2"/><circle cx="28" cy="20" fill="white" r="2.5" stroke="url(#g4)" stroke-width="2"/><circle cx="38" cy="14" fill="white" r="2.5" stroke="url(#g4)" stroke-width="2"/></svg></div>
          <div class="orbit-wrapper orbit-4"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g5" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><circle cx="20" cy="20" fill="white" r="12" stroke="url(#g5)" stroke-width="2"/><line stroke="url(#g5)" stroke-linecap="round" stroke-width="2" x1="29" y1="29" x2="40" y2="40"/></svg></div>
        </div>
        <h1 class="empty-state-title">Need help with UX research?</h1>
        <p>Select to see recommended methods.</p>
      </div>
    </div>

    <!-- FOOTER NOTE -->
    <p class="footer-note">This tool covers the most common scenarios. For specialized research methods see NN/g's full landscape.</p>

    <!-- FOOTER -->
    <footer class="page-footer">
      <button class="footer-link" onclick="openGlossary()"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -1px;"><path d="M2 3h6a4 4 0 0 1 4 4v14a3 3 0 0 0-3-3H2z"/><path d="M22 3h-6a4 4 0 0 0-4 4v14a3 3 0 0 1 3-3h7z"/></svg> Glossary</button>
      <a href="https://www.linkedin.com/in/miguel-tomas-gomes/" target="_blank" rel="noopener" class="footer-link"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" style="vertical-align: -1px;"><path d="M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6"/><polyline points="15 3 21 3 21 9"/><line x1="10" y1="14" x2="21" y2="3"/></svg> Send Feedback</a>
    </footer>
  </main>

  <!-- GLOSSARY MODAL -->
  <div class="glossary-modal" id="glossaryModal" onclick="closeGlossary(event)">
    <div class="glossary-content" onclick="event.stopPropagation()">
      <div class="glossary-header">
        <div class="glossary-title">Glossary</div>
        <button class="modal-close" onclick="closeGlossary()">&times;</button>
      </div>
      <div class="glossary-body" id="glossaryBody"></div>
    </div>
  </div>

<script>
  // ---- GLOSSARY ----
  const glossary = {
    'a-b-test': {
      term: 'A/B test',
      def: 'An experiment where users are randomly split between two versions (A and B) to see which performs better on a specific metric.'
    },
    'p-value': {
      term: 'p-value',
      def: 'The probability of seeing this result (or more extreme) if there\'s actually no difference. Lower = stronger evidence. Typically, p < 0.05 is considered "significant".'
    },
    'binomial-test': {
      term: 'Binomial test',
      def: 'A simple statistical check for whether a split (e.g., 16 chose A, 4 chose B) is too lopsided to be random chance.'
    },
    'confidence-interval': {
      term: 'Confidence interval',
      def: 'A range showing where the true effect likely falls (e.g., +3% to +9%). Wider intervals mean less certainty.'
    },
    'effect-size': {
      term: 'Effect size',
      def: 'How big the difference is (e.g., +6 percentage points). Separate from whether it\'s statistically significant. A tiny effect can be "significant" with enough data.'
    },
    'mde': {
      term: 'Minimum detectable effect (MDE)',
      def: 'The smallest improvement worth detecting. If a 2% lift isn\'t worth the effort, don\'t design a test to detect it. MDE drives sample size.'
    },
    'false-positive': {
      term: 'False positive rate',
      def: 'How often you\'ll declare a "winner" when there\'s actually no difference. Usually set at 5% (1 in 20 tests will be a false alarm).'
    },
    'statistical-significance': {
      term: 'Statistical significance',
      def: 'The result is unlikely to be random noise (typically p < 0.05). It doesn\'t mean the effect is large or important, just that it\'s probably real.'
    },
    'sample-size': {
      term: 'Sample size',
      def: 'The number of users in your test. Larger samples detect smaller effects but take longer to collect. Calculate based on your minimum detectable effect.'
    },
    'card-sort': {
      term: 'Card sort',
      def: 'A method where users group content items into categories that make sense to them. Open card sorts let users create labels; closed card sorts use your predefined categories.'
    },
    'tree-test': {
      term: 'Tree test',
      def: 'A method to test findability in a navigation structure. Users click through a text-only hierarchy to find items. No visual design, just labels.'
    },
    'ia': {
      term: 'Information architecture (IA)',
      def: 'Information Architecture (IA) is how content is organized and labeled to help users find what they need.'
    },
    'mental-model': {
      term: 'Mental model',
      def: 'How users expect something to work based on prior experience. Good design matches users\' mental models so things feel intuitive.'
    },
    'session-replay': {
      term: 'Session replay',
      def: 'A recording of a user\'s screen as they navigate your product. Shows clicks, scrolls, rage clicks, and hesitations without needing a live session.'
    },
    'heuristic-evaluation': {
      term: 'Heuristic evaluation',
      def: 'An expert review where a UX specialist identifies usability issues based on established principles (heuristics) like visibility, consistency, and error prevention.'
    },
    'contextual-inquiry': {
      term: 'Contextual inquiry',
      def: 'Observing and interviewing users in their real environment (home, office) while they do real tasks. Reveals context that lab studies miss.'
    },
    'field-study': {
      term: 'Field study',
      def: 'Research conducted in users\' natural environment rather than a lab. Includes observation, interviews, and shadowing to understand real-world behavior.'
    },
    'journey-map': {
      term: 'Journey map',
      def: 'A visual timeline of a user\'s experience across touchpoints. Shows actions, thoughts, emotions, and pain points from the user\'s perspective.'
    },
    'diary-study': {
      term: 'Diary study',
      def: 'Users log their experiences over days or weeks in a journal or app. Captures behavior over time that a single session would miss.'
    },
    'focus-group': {
      term: 'Focus group',
      def: 'A moderated group discussion (usually 6-10 people) to explore attitudes and reactions. Good for generating ideas, but groupthink can skew results.'
    },
    'persona': {
      term: 'Persona',
      def: 'A fictional character representing a user type, based on research. Includes goals, frustrations, and behaviors. Helps teams design for real needs, not assumptions.'
    },
    'usability-test': {
      term: 'Usability test',
      def: 'Watching real users attempt tasks with your product to find where they struggle. The gold standard for finding usability problems.'
    },
    'first-click': {
      term: 'First-click testing',
      def: 'Measuring whether users click the right place first when starting a task. If the first click is correct, users succeed 87% of the time.'
    },
    'five-second': {
      term: '5-second test',
      def: 'Show a design for 5 seconds, then ask what users remember. Tests first impressions and whether key messages are noticed.'
    },
    'jobs-to-be-done': {
      term: 'Jobs-to-be-done',
      def: 'A framework focusing on what users are trying to accomplish (the "job") rather than demographics or feature requests. "People don\'t want a drill, they want a hole."'
    },
    'maxdiff': {
      term: 'MaxDiff survey',
      def: 'A survey technique that forces users to pick the most and least important items from sets. Produces clearer priorities than simple rating scales.'
    },
    'randomize': {
      term: 'Randomize',
      def: 'Showing options in a different order for each participant to avoid order bias. For example, if testing A vs B, show A first to half the participants and B first to the other half.'
    },
    'representative': {
      term: 'Representative',
      def: 'Participants who match your target userbase in relevant characteristics (e.g., experience level, use case, demographics). A representative sample ensures findings apply to your actual users.'
    }
  };

  function openGlossary() {
    const body = document.getElementById('glossaryBody');
    const sortedItems = Object.values(glossary).sort((a, b) =>
      a.term.toLowerCase().localeCompare(b.term.toLowerCase())
    );
    body.innerHTML = sortedItems.map(item => `
      <div class="glossary-item">
        <div class="glossary-term">${item.term}</div>
        <div class="glossary-def">${item.def}</div>
      </div>
    `).join('');
    document.getElementById('glossaryModal').classList.add('active');
  }

  function closeGlossary(event) {
    if (!event || event.target === document.getElementById('glossaryModal')) {
      document.getElementById('glossaryModal').classList.remove('active');
    }
  }

  // ---- CONFIG ----
  const sampleOptions = {
    clarity: [
      { value: "c1", label: "1–5 participants" },
      { value: "c2", label: "6–14 participants" },
      { value: "c3", label: "15+ participants" }
    ],
    comparison: [
      { value: "cmp1", label: "3–9 participants" },
      { value: "cmp2", label: "10–14 participants" },
      { value: "cmp3", label: "30+ participants" }
    ],
    conversion: [
      { value: "cv1", label: "16–40 per version" },
      { value: "cv2", label: "40–100 per version" },
      { value: "cv3", label: "100+ per version" }
    ],
    diagnostic: [
      { value: "d1", label: "3–5 participants" },
      { value: "d2", label: "6–12 participants" },
      { value: "d3", label: "12+ participants" }
    ],
    discovery: [
      { value: "disc1", label: "5–8 participants" },
      { value: "disc2", label: "8–15 participants" },
      { value: "disc3", label: "15+ participants (or survey)" }
    ],
    organization: [
      { value: "org1", label: "10–15 participants" },
      { value: "org2", label: "15–30 participants" },
      { value: "org3", label: "30+ participants" }
    ]
  };

  const scenarios = {
    // ========== IS THIS CLEAR? ==========
    clarity: {
      c1: {
        badgeClass: "do-this",
        badgeText: "Qualitative",
        method: "Open-ended comprehension interview",
        rec: "Watch users interpret your message. At this scale, one confused user is a signal worth acting on.",
        steps: [
          "Show the copy on the real screen, since context matters.",
          "Ask: \"What does this mean to you?\"",
          "Ask: \"What do you think will happen?\"",
          "List the top 2–3 misunderstandings. Don't calculate percentages."
        ],
        outcome:
          "<strong>Why it works:</strong> 5 users typically find 85% of usability problems. You're looking for patterns, not statistics.",
        mistake: [
          "Reporting \"20% failed\" with 5 people. Focus on themes and examples instead of percentages."
        ],
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">5-second test</div>' +
            '<div class="method-alt-when">Good for: Testing first impressions. Show briefly, hide, then ask what they remember.</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Highlighter test</div>' +
            '<div class="method-alt-when">Good for: Testing whether users notice the key message in context.</div>' +
          '</div>',
        present: [
          "We spoke to 4 users and saw the same misunderstanding twice. That's enough to revise the copy before broader testing."
        ]
      },
      c2: {
        badgeClass: "do-this",
        badgeText: "Structured",
        method: "Scored comprehension check",
        rec: "Add structure without statistics. Score each response and group failures into themes.",
        steps: [
          "Show the design or copy in context.",
          "Ask the same prompts for everyone (consistency matters).",
          "Score each response: Pass / Partial / Fail.",
          "Group failures into themes (e.g., \"thought this meant X\").",
          "Rank themes by frequency. 6 of 10 failing on the same thing is actionable."
        ],
        outcome:
          "<strong>Why it works:</strong> This gives you evidence without the overhead of formal stats. You're still in find-and-fix mode.",
        mistake:
          "<strong>Avoid:</strong> Calculating p-values at this stage. You're diagnosing problems, not proving effects.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Tree testing</div>' +
            '<div class="method-alt-when">Good for: Testing findability (e.g., "Where would you go to do X?").</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Closed card sort</div>' +
            '<div class="method-alt-when">Good for: Checking if your labels match users\' mental models.</div>' +
          '</div>',
        present: [
          "We ran structured comprehension checks with 10 users. 6 misinterpreted the same label, so we're updating that wording."
        ]
      },
      c3: {
        badgeClass: "do-this",
        badgeText: "Measurable",
        method: "Comprehension rate",
        rec: "At 15-30 participants, you can report pass rates with more precision (e.g., '14 of 20 passed vs. 8 of 20 before'). Large improvements are actionable even without statistical tests.",
        steps: [
          "Keep scoring consistent: same prompts, same pass/fail criteria.",
          "Report simply: \"14 of 20 understood correctly (70%).\"",
          "If iterating, show before/after: \"8/20 → 14/20.\"",
          "Keep a list of remaining failure themes for the next round."
        ],
        outcome:
          "<strong>Rule of thumb:</strong> 18/20 passing is usually good enough. No A/B test needed to move on.",
        mistake:
          "<strong>Avoid:</strong> Running an A/B test just to \"prove\" comprehension. If most people get it, you typically have enough evidence to move forward.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">First-click testing</div>' +
            '<div class="method-alt-when">Good for: Showing that most users start in the right place for a task.</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Highlighter test</div>' +
            '<div class="method-alt-when">Good for: Evidence that users notice the primary message immediately.</div>' +
          '</div>',
        present: [
          "In our latest round, 14 of 20 interpreted the message correctly versus 8 of 20 before. That 6-person improvement (30 percentage points) is large enough to ship."
        ],
        howToMeasure: {
          steps: [
            {
              title: "Calculate task success rate",
              desc: "(successful completions ÷ total attempts) × 100",
              example: "14 ÷ 20 = 70% success rate"
            },
            {
              title: "Track improvement",
              desc: "Compare before/after rates",
              example: "Before: 8/20 (40%). After: 14/20 (70%). Δ = +30pp."
            }
          ],
          table: {
            title: "Rule of thumb benchmarks",
            col1: "Success rate",
            col2: "Interpretation",
            rows: [
              { users: "90%+", need: "Excellent, ship confidently" },
              { users: "70–89%", need: "Good, minor fixes may help" },
              { users: "Below 70%", need: "Needs work, investigate failures" }
            ]
          }
        }
      }
    },

    // ========== WHICH OPTION IS BETTER? ==========
    comparison: {
      cmp1: {
        badgeClass: "do-this",
        badgeText: "Qualitative",
        method: "Preference interview",
        rec: "At this scale, reasons matter more than votes. A 5/4 split tells you nothing, but consistent themes are actionable.",
        steps: [
          "Show both options; randomize order for each person.",
          "Ask: \"If you had to choose, which would you use?\"",
          "Ask: \"What made that one feel better?\"",
          "Cluster reasons into themes (e.g., \"safer\", \"clearer\")."
        ],
        outcome:
          "<strong>Key insight:</strong> Preference doesn't predict behavior. Use this to pick a candidate, then validate with an A/B test.",
        mistake: [
          "Reporting \"56% preferred A\" with 9 people. Focus on themes and examples instead of percentages."
        ],
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Desirability testing</div>' +
            '<div class="method-alt-when">Good for: Learning which design feels most "friendly", "professional", etc.</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Sentence completion</div>' +
            '<div class="method-alt-when">Good for: Testing tone, e.g. \"This product seems like it would…\"</div>' +
          '</div>',
        present: [
          "In 7 interviews, participants consistently described version B as \"more trustworthy\". We're validating B in a behavior test next."
        ],
        howToStructure: {
          intro: "Turn raw quotes into themes, not percentages.",
          steps: [
            {
              title: "Log quote → reason → theme",
              example: "\"I trust this one more\" → Familiar patterns → <strong>Trust</strong><br>\"This feels faster\" → Less to read → <strong>Efficiency</strong>"
            },
            {
              title: "Cluster into themes",
              desc: "If 2–3 users independently give the same reason, it's a theme. One mention = hypothesis."
            }
          ]
        }
      },
      cmp2: {
        badgeClass: "directional",
        badgeText: "Directional",
        method: "Paired preference test",
        rec: "You can note the vote direction, but reasons still matter most. 60/40 splits are usually meaningless.",
        steps: [
          "Show both options; swap order each session to avoid bias.",
          "Ask which they'd trust more, then immediately ask why.",
          "Record the split (e.g., 8 vs 6) for context only.",
          "Use split + reasons to pick a candidate for behavior testing."
        ],
        outcome:
          "<strong>Look for:</strong> 80/20+ splits with consistent themes. 60/40 with scattered reasons = inconclusive.",
        mistake:
          "<strong>Avoid:</strong> Treating a 60/40 split as a win. If reasons don't cluster, treat it as a tie.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Remote unmoderated preference test</div>' +
            '<div class="method-alt-when">Good for: Quick directional signal from a slightly larger sample.</div>' +
          '</div>',
        present: [
          "9 of 12 participants chose concept B and described it as clearer. We're taking B into an A/B test."
        ]
      },
      cmp3: {
        badgeClass: "directional",
        badgeText: "Testable",
        method: "Preference test with binomial check",
        rec: "At 30+ participants, you can run a binomial test. A clear preference (70%+) is more meaningful than a weak split.",
        steps: [
          "Show both options to each participant (within-subjects design).",
          "Ask: \"Which would you use?\" then \"Why?\"",
          "Summarise the split (e.g., 21 chose A, 9 chose B).",
          "Run a binomial test only if one option clearly dominates.",
          "If near 50/50, treat it as a tie at this level of sample size."
        ],
        outcome:
          "<strong>Reality check:</strong> 55/45 is weak even with 100 people. 21/9 (70%) is meaningful at 30 people.",
        mistake:
          "<strong>Avoid:</strong> Calculating p-values on weak splits. Treat 60/40 as a tie at this level of sample size.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Multi-variant preference test</div>' +
            '<div class="method-alt-when">Good for: 3–4 creative directions where you want to narrow to 1–2.</div>' +
          '</div>',
        present: [
          "In a 24-person preference test, 19 chose design A (p < 0.01 vs. 50/50). We're now validating A with live behavior data."
        ],
        howToMeasure: {
          steps: [
            {
              title: "Count the split",
              desc: "Tally votes for each option. Example: 19 chose A, 5 chose B."
            },
            {
              title: "Calculate preference share",
              desc: "(votes for winner ÷ total) × 100",
              example: "19 ÷ 24 = 79%"
            },
            {
              title: "Get p-value",
              desc: "In Google Sheets or Excel:",
              formula: "=BINOM.TEST(19, 24, 0.5, 2)",
              note: "Replace 19 with winner votes, 24 with total votes."
            }
          ],
          table: {
            title: "Quick reference: p < 0.05 is the common threshold",
            col1: "Sample size",
            col2: "Preference share for significance",
            rows: [
              { users: "30–40 participants", need: "75%+" },
              { users: "40+ participants", need: "70%+" }
            ]
          }
        }
      }
    },

    // ========== DOES THIS CONVERT? ==========
    conversion: {
      cv1: {
        badgeClass: "directional",
        badgeText: "Exploratory",
        method: "Small A/B test (large effects only)",
        rec: "You can run an A/B test, but only bold changes will show up. This is for exploration, not proof.",
        steps: [
          "<strong>Before you start:</strong> Define your one primary metric.",
          "Randomize which version each participant sees (no self-selection).",
          "Decide your sample size in advance. Don't peek at results until you reach it.",
          "At ~40 participants per version, look for obvious differences only. Ignore tiny lifts."
        ],
        outcome:
          "<strong>Expect:</strong> \"No clear difference\" is normal unless the change is dramatic (~20%+ lift).",
        mistake:
          "<strong>Avoid:</strong> Peeking at results before reaching your target sample size, chasing p-values, or stopping early when you see a \"winner\". These inflate false positive rates.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Task-based usability test</div>' +
            '<div class="method-alt-when">Good for: Understanding <em>why</em> users fail before you measure <em>how often</em>.</div>' +
          '</div>',
        statsGuide: 'twoprop',
        present: [
          "We ran a small A/B test with 40 users per version. Version B showed a 15pp higher completion rate. That's a strong signal, but not conclusive, so we'll validate with more traffic."
        ]
      },
      cv2: {
        badgeClass: "ab",
        badgeText: "Standard A/B",
        method: "A/B test (medium effects)",
        rec: "This is a standard A/B test setup for detecting medium effects. With clean randomisation and stable traffic, ~10–15% lifts should be detectable.",
        steps: [
          "<strong>Before you start:</strong> Choose one primary metric. The decision is based on this alone.",
          "Calculate your target sample size and commit to it.",
          "Randomize assignment, no manual sorting.",
          "Run for at least one full business cycle (often 1–2 weeks).",
          "Report effect size + confidence interval, not just \"B won\"."
        ],
        outcome:
          "<strong>This is validation, not exploration.</strong> Predetermined sample size + single metric prevents the false positives that plague most A/B tests.",
        mistake:
          "<strong>Avoid:</strong> Stopping when the p-value \"looks good\", or testing 15 metrics and reporting the best one. Both can dramatically inflate false positives.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Sequential A/B test</div>' +
            '<div class="method-alt-when">Good for: Frequent testing with formal early-stopping rules (requires proper design).</div>' +
          '</div>',
        statsGuide: 'twoprop',
        present: [
          "We tested the new checkout with 100 users per version. Conversion improved from 12% to 18%, a 50% relative lift (6 percentage points). This is a strong directional signal, but the confidence interval is still wide, so we'll monitor closely after launch."
        ],
        howToMeasure: {
          steps: [
            {
              title: "Calculate conversion rate",
              desc: "(conversions ÷ visitors) × 100",
              example: "A: 12 ÷ 100 = 12%. B: 18 ÷ 100 = 18%."
            },
            {
              title: "Calculate lift",
              desc: "Relative: ((B − A) ÷ A) × 100. Absolute: B − A.",
              example: "Relative: 50% lift. Absolute: 6 percentage points."
            },
            {
              title: "Get p-value",
              desc: "Use an online A/B test calculator (Evan Miller, ABTestGuide, etc.).",
              note: "Enter visitors and conversions for each version. Spreadsheet formulas are easy to misapply."
            }
          ],
          table: {
            title: "Approximate sample sizes (rule of thumb, 80% power)<br><small style='font-weight: normal; opacity: 0.8;'>Note: These are general guidelines. Your specific case may vary based on effect size, baseline rate, and acceptable error rates.</small>",
            col1: "Baseline rate",
            col2: "Sample needed",
            rows: [
              { users: "5% baseline", need: "~400/version to detect 50% lift" },
              { users: "10% baseline", need: "~200/version to detect 50% lift" },
              { users: "20% baseline", need: "~100/version to detect 50% lift" }
            ]
          }
        }
      },
      cv3: {
        badgeClass: "ab",
        badgeText: "High-power A/B",
        method: "A/B test with confidence",
        rec: "At 100+ users per version, you can more reliably detect smaller effects and narrow your confidence intervals.",
        steps: [
          "<strong>Before you start:</strong> Define your single primary metric and minimum detectable effect.",
          "Calculate sample size based on the smallest lift worth implementing.",
          "Randomize; avoid any self-selection or manual assignment.",
          "Run for at least one full cycle to avoid day-of-week effects.",
          "Report effect size + 95% confidence interval."
        ],
        outcome:
          "<strong>This is confirmation.</strong> If there's still \"no difference\" at this size, the change probably doesn't move the needle. That's a valid finding, so ship or kill with confidence.",
        mistake:
          "Confusing statistical significance with practical significance. A 0.5% lift can be \"significant\" with large samples but still not worth implementing.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Multi-armed bandit</div>' +
            '<div class="method-alt-when">Good for: Many variants where you want to shift traffic to winners over time (requires infrastructure).</div>' +
          '</div>',
        statsGuide: 'twoprop',
        present: [
          "We tested the simplified checkout with 200 users per version. Conversion improved from 10% to 12% (20% relative lift, +2pp; p = 0.03). If this holds, the annualized impact is ~$1.2M, though the 95% CI is wide at this sample size."
        ],
        howToMeasure: {
          steps: [
            {
              title: "Calculate conversion rate",
              desc: "(conversions ÷ visitors) × 100",
              example: "A: 20 ÷ 200 = 10%. B: 24 ÷ 200 = 12%."
            },
            {
              title: "Calculate lift",
              desc: "Relative: ((B − A) ÷ A) × 100. Absolute: B − A.",
              example: "Relative: 20% lift. Absolute: 2 percentage points."
            },
            {
              title: "Get p-value and confidence interval",
              desc: "Use an A/B test calculator (Evan Miller, ABTestGuide, etc.).",
              note: "Enter visitors and conversions for each version. Look for p < 0.05 and check the 95% CI doesn't cross zero."
            }
          ],
          table: {
            title: "Approximate sample sizes (rule of thumb, 80% power)<br><small style='font-weight: normal; opacity: 0.8;'>Note: These are general guidelines. Your specific case may vary based on effect size, baseline rate, and acceptable error rates.</small>",
            col1: "Effect size",
            col2: "Sample needed",
            rows: [
              { users: "To detect 20% lift", need: "~400/version at 10% baseline" },
              { users: "To detect 10% lift", need: "~1,600/version at 10% baseline" },
              { users: "To detect 5% lift", need: "~6,400/version at 10% baseline" }
            ]
          }
        }
      }
    },

    // ========== WHAT'S CAUSING PROBLEMS? ==========
    diagnostic: {
      d1: {
        badgeClass: "do-this",
        badgeText: "Deep dive",
        method: "Diagnostic interviews",
        rec: "With 3–5 users, focus on understanding the problem deeply. You're looking for root causes, not statistics.",
        steps: [
          "Recruit users who recently experienced the problem (e.g., abandoned a flow).",
          "Ask them to walk you through what happened and how they felt.",
          "Probe for context: \"What were you trying to accomplish?\"",
          "Look for patterns in frustration points and workarounds."
        ],
        outcome:
          "<strong>Goal:</strong> Understand the 'why' behind the behavior. 3 users sharing the same frustration is a strong signal.",
        mistake:
          "Jumping to solutions before understanding the problem. Let users tell you what went wrong before you propose fixes.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Session replay review</div>' +
            '<div class="method-alt-when">Good for: Seeing exactly where users get stuck without needing live sessions.</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Support ticket analysis</div>' +
            '<div class="method-alt-when">Good for: Understanding recurring complaints at scale.</div>' +
          '</div>',
        present: [
          "We interviewed 4 users who abandoned checkout. All mentioned confusion about shipping costs appearing late. We're moving that info earlier."
        ]
      },
      d2: {
        badgeClass: "do-this",
        badgeText: "Mixed methods",
        method: "Interviews + analytics review",
        rec: "Combine qualitative depth with quantitative context. Analytics tells you where, interviews tell you why.",
        steps: [
          "Start with analytics: Where do users drop off? Which pages have high exit rates?",
          "Interview 6–12 users who match the drop-off pattern.",
          "Ask: \"What were you trying to do? What stopped you?\"",
          "Cross-reference interview themes with analytics data."
        ],
        outcome:
          "<strong>Why it works:</strong> Analytics shows the 'what', interviews reveal the 'why'. Together, you build a complete picture.",
        mistake:
          "Relying on analytics alone. Numbers show where problems are, not why they happen.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Field study / contextual inquiry</div>' +
            '<div class="method-alt-when">Good for: Understanding how users interact with your product in their real environment.</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Heuristic evaluation</div>' +
            '<div class="method-alt-when">Good for: Expert review to identify obvious usability issues quickly.</div>' +
          '</div>',
        present: [
          "Analytics showed 40% drop-off on step 3. In 8 interviews, users consistently mentioned form validation was unclear. We're redesigning the error states."
        ]
      },
      d3: {
        badgeClass: "do-this",
        badgeText: "Comprehensive",
        method: "Multi-source diagnostic",
        rec: "At 12+ users, you can triangulate across multiple data sources for confident problem identification.",
        steps: [
          "Combine: analytics, session replays, support tickets, and interviews.",
          "Create a problem severity matrix: frequency × impact.",
          "Prioritise problems that are both common and painful.",
          "Validate top problems with stakeholders before designing solutions."
        ],
        outcome:
          "<strong>Deliverable:</strong> A prioritised list of problems with evidence from multiple sources. This builds stakeholder confidence.",
        mistake:
          "Analysis paralysis. At some point, you have enough evidence to act. Don't wait for perfect data.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Journey mapping workshop</div>' +
            '<div class="method-alt-when">Good for: Synthesising findings with stakeholders and building shared understanding.</div>' +
          '</div>',
        present: [
          "We triangulated analytics, 15 interviews, and 200 support tickets. The top 3 pain points account for 70% of complaints. We're addressing them in order."
        ]
      }
    },

    // ========== WHAT DO USERS NEED? ==========
    discovery: {
      disc1: {
        badgeClass: "do-this",
        badgeText: "Exploratory",
        method: "Discovery interviews",
        rec: "With 5–8 users, explore needs openly. You're not testing solutions, you're understanding problems.",
        steps: [
          "Recruit users who match your target audience.",
          "Ask about their current behavior: \"How do you currently handle X?\"",
          "Probe for pain points: \"What's frustrating about that?\"",
          "Explore workarounds: \"Have you tried anything else?\""
        ],
        outcome:
          "<strong>Goal:</strong> Uncover needs users might not articulate directly. Look for jobs-to-be-done and unmet needs.",
        mistake:
          "Asking \"Would you use this?\" since users can't predict future behavior. Focus on current problems and habits.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Diary study</div>' +
            '<div class="method-alt-when">Good for: Understanding behavior over time, not just a single moment.</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Competitive analysis</div>' +
            '<div class="method-alt-when">Good for: Understanding what alternatives users currently use.</div>' +
          '</div>',
        present: [
          "We interviewed 6 users about their workflow. 5 mentioned manually tracking X in spreadsheets. That's a clear opportunity for automation."
        ]
      },
      disc2: {
        badgeClass: "do-this",
        badgeText: "Structured",
        method: "Needs assessment with themes",
        rec: "At 8–15 users, you can identify reliable themes. Look for needs that appear across multiple interviews.",
        steps: [
          "Use a consistent interview guide across all sessions.",
          "After each session, note key needs and pain points.",
          "Cluster needs into themes after 8+ interviews.",
          "Rank themes by frequency and intensity."
        ],
        outcome:
          "<strong>Rule of thumb:</strong> A need mentioned by 5+ users across different segments is worth prioritising.",
        mistake:
          "Treating all needs equally. Some are nice-to-haves, others are deal-breakers. Probe for intensity.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Focus groups</div>' +
            '<div class="method-alt-when">Good for: Generating ideas and seeing how users react to each other\'s needs.</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Persona development</div>' +
            '<div class="method-alt-when">Good for: Synthesising user needs into actionable archetypes.</div>' +
          '</div>',
        present: [
          "Across 12 interviews, we identified 4 core needs. 'Easy export' appeared in 10 sessions, making it our top priority."
        ],
        howToStructure: {
          intro: "Rank by frequency × intensity, not just count.",
          steps: [
            {
              title: "Log need → frequency → intensity",
              example: "Easy export → 10/12 users → \"deal-breaker\"<br>Dark mode → 4/12 users → \"nice-to-have\""
            },
            {
              title: "Prioritise by both dimensions",
              desc: "High frequency + high intensity = top priority. High frequency + low intensity = consider. Low frequency = park it."
            }
          ]
        }
      },
      disc3: {
        badgeClass: "do-this",
        badgeText: "Quantitative",
        method: "Survey + interviews",
        rec: "At 15+ users, add a survey to quantify how common each need is. Interviews give depth, surveys give breadth.",
        steps: [
          "Start with interviews to discover needs (you can't survey about needs you don't know).",
          "Build a survey based on interview themes.",
          "Ask: \"How important is X to you?\" and \"How satisfied are you with current solutions?\"",
          "Use importance × dissatisfaction to prioritise opportunities."
        ],
        outcome:
          "<strong>Deliverable:</strong> A prioritised opportunity map. High importance + low satisfaction = biggest opportunity.",
        mistake:
          "Surveying before interviewing. You'll miss needs you didn't think to ask about.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">MaxDiff survey</div>' +
            '<div class="method-alt-when">Good for: Forcing users to prioritise needs when everything seems "important".</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Jobs-to-be-done framework</div>' +
            '<div class="method-alt-when">Good for: Structuring needs around outcomes, not features.</div>' +
          '</div>',
        present: [
          "We surveyed 150 users on 8 needs from our interviews. 'Real-time sync' ranked highest in importance and lowest in satisfaction. That's our next focus."
        ]
      }
    },

    // ========== HOW DO USERS ORGANIZE THIS? ==========
    organization: {
      org1: {
        badgeClass: "do-this",
        badgeText: "Exploratory",
        method: "Open card sort",
        rec: "With 10–15 users, discover how users naturally group your content. You're finding their mental model, not validating yours.",
        steps: [
          "Give users cards with content items (features, pages, categories).",
          "Ask them to group cards in a way that makes sense to them.",
          "Ask them to name each group.",
          "Look for patterns in groupings and labels."
        ],
        outcome:
          "<strong>Goal:</strong> Discover unexpected groupings. If users consistently put X with Y, your IA should reflect that.",
        mistake:
          "Using your internal team's labels on cards. Use plain language users would recognise.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Open-ended interview about navigation</div>' +
            '<div class="method-alt-when">Good for: Understanding how users think about finding information before you test structures.</div>' +
          '</div>',
        present: [
          "In our card sort with 12 users, 9 grouped 'Billing' with 'Account Settings', not under 'Help' where we had it. We're moving it."
        ],
        howToMeasure: {
          steps: [
            {
              title: "Calculate agreement rate",
              desc: "(users who grouped items together ÷ total users) × 100",
              example: "9 of 12 grouped Billing with Account → 75% agreement"
            },
            {
              title: "Identify strong clusters",
              desc: "Look for groupings with 70%+ agreement",
              note: "These are your strongest signals. Build your IA around them."
            }
          ],
          table: {
            title: "Interpreting agreement rates",
            col1: "Agreement",
            col2: "Interpretation",
            rows: [
              { users: "70%+", need: "Strong signal, use this grouping" },
              { users: "50–69%", need: "Weak signal, explore further" },
              { users: "Below 50%", need: "No consensus, test alternatives" }
            ]
          }
        }
      },
      org2: {
        badgeClass: "do-this",
        badgeText: "Validation",
        method: "Tree test",
        rec: "At 15–30 users, test whether users can find content in your proposed structure. This validates your IA before building it.",
        steps: [
          "Create a text-only hierarchy of your navigation (no visual design).",
          "Give users tasks: \"Where would you find X?\"",
          "Measure: success rate, directness (first click correct?), and time.",
          "Iterate on labels and structure based on failure points."
        ],
        outcome:
          "<strong>Benchmark:</strong> 80%+ success rate on critical tasks is a good target. Below 60% = rethink the structure.",
        mistake:
          "Testing with a visual design. Tree testing isolates navigation structure from visual hierarchy.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">First-click testing</div>' +
            '<div class="method-alt-when">Good for: Testing if users start in the right place, even if they can\'t complete the task.</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Closed card sort</div>' +
            '<div class="method-alt-when">Good for: Validating your categories when you already have a proposed structure.</div>' +
          '</div>',
        present: [
          "We tree-tested our new IA with 20 users. 'Change password' had 90% success. 'Cancel subscription' had 45%, so we're renaming that section."
        ],
        howToMeasure: {
          steps: [
            {
              title: "Calculate findability (success rate)",
              desc: "(users who found the right destination ÷ total users) × 100",
              example: "18 of 20 found 'Change password' → 90% findability"
            },
            {
              title: "Calculate directness",
              desc: "(users who went straight there ÷ users who succeeded) × 100",
              example: "15 of 18 took the direct path → 83% directness"
            }
          ],
          table: {
            title: "Tree test benchmarks",
            col1: "Findability",
            col2: "Interpretation",
            rows: [
              { users: "80%+", need: "Good, structure works" },
              { users: "60–79%", need: "Weak, check labels or depth" },
              { users: "Below 60%", need: "Rethink the structure" }
            ]
          }
        }
      },
      org3: {
        badgeClass: "do-this",
        badgeText: "High confidence",
        method: "Card sort + tree test combined",
        rec: "At 30+ users, combine methods for robust IA validation. Card sort discovers, tree test validates.",
        steps: [
          "Run an open card sort first (15+ users) to discover natural groupings.",
          "Build your proposed IA based on card sort results.",
          "Tree test the new IA (15+ users) to validate findability.",
          "Iterate until critical tasks hit 80%+ success."
        ],
        outcome:
          "<strong>Confidence:</strong> With 30+ users across both methods, you can confidently ship the IA knowing it matches user mental models.",
        mistake:
          "Skipping the card sort and only tree testing. You might validate a bad structure just because users eventually find things.",
        altMethods:
          '<div class="method-alt">' +
            '<div class="method-alt-name">Reverse card sort</div>' +
            '<div class="method-alt-when">Good for: Testing if your category labels make sense by having users predict what\'s inside.</div>' +
          '</div>' +
          '<div class="method-alt">' +
            '<div class="method-alt-name">Comparative tree test</div>' +
            '<div class="method-alt-when">Good for: Testing 2–3 IA variants against each other to pick the best structure.</div>' +
          '</div>',
        present: [
          "Card sort (30 users) revealed 5 natural groupings. Tree test (35 users) validated 4 of them at 85%+ success. We're redesigning the 5th."
        ],
        howToMeasure: {
          steps: [
            {
              title: "Card sort: agreement rate",
              desc: "(users who grouped items together ÷ total users) × 100",
              example: "24 of 30 grouped Settings items together → 80% agreement"
            },
            {
              title: "Tree test: findability",
              desc: "(users who found destination ÷ total users) × 100",
              example: "30 of 35 found 'Cancel subscription' → 86% findability"
            },
            {
              title: "Combined decision",
              desc: "High agreement + high findability = ship. Low on either = iterate.",
              note: "Card sort tells you what to build. Tree test tells you if it works."
            }
          ],
          table: {
            title: "When to ship vs iterate",
            col1: "Result",
            col2: "Action",
            rows: [
              { users: "70%+ agreement AND 80%+ findability", need: "Ship with confidence" },
              { users: "Low agreement, any findability", need: "Revisit your groupings" },
              { users: "High agreement, low findability", need: "Fix labels or structure depth" }
            ]
          }
        }
      }
    }
  };

  // ---- UPDATE SAMPLE OPTIONS ----
  document.getElementById('intentSelect').addEventListener('change', function() {
    const intent = this.value;
    const sampleSelect = document.getElementById('sampleSelect');

    if (!intent) {
      sampleSelect.innerHTML = '<option value="">Select...</option>';
      sampleSelect.disabled = true;
      document.getElementById('sampleSelectWrapper').classList.add('disabled');
      document.getElementById('recommendation').innerHTML = `
        <div class="empty-state">
          <div class="floating-icons">
            <div class="orbit-wrapper orbit-1"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g1a" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><rect fill="white" height="16" rx="3" ry="3" stroke="url(#g1a)" stroke-width="2" width="6" x="10" y="22"/><rect fill="white" height="24" rx="3" ry="3" stroke="url(#g1a)" stroke-width="2" width="6" x="21" y="14"/><rect fill="white" height="28" rx="3" ry="3" stroke="url(#g1a)" stroke-width="2" width="6" x="32" y="10"/></svg></div>
            <div class="orbit-wrapper orbit-2"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g2a" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><circle cx="24" cy="24" fill="white" r="16" stroke="url(#g2a)" stroke-width="2"/><line stroke="url(#g2a)" stroke-width="2" x1="24" x2="24" y1="24" y2="8"/><line stroke="url(#g2a)" stroke-width="2" x1="24" x2="38" y1="24" y2="30"/></svg></div>
            <svg class="icon-checklist" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g3a" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><rect fill="white" height="32" rx="4" ry="4" stroke="url(#g3a)" stroke-width="1.2" width="24" x="12" y="8"/><rect fill="white" height="4" rx="1" ry="1" stroke="url(#g3a)" stroke-width="1.2" width="4" x="16" y="16"/><rect fill="white" height="4" rx="1" ry="1" stroke="url(#g3a)" stroke-width="1.2" width="4" x="16" y="24"/><polyline fill="none" points="22,18 24,20 28,16" stroke="url(#g3a)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"/><polyline fill="none" points="22,26 24,28 28,24" stroke="url(#g3a)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"/></svg>
            <div class="orbit-wrapper orbit-3"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g4a" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><polyline fill="none" points="8,32 18,26 28,20 38,14" stroke="url(#g4a)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/><circle cx="8" cy="32" fill="white" r="2.5" stroke="url(#g4a)" stroke-width="2"/><circle cx="18" cy="26" fill="white" r="2.5" stroke="url(#g4a)" stroke-width="2"/><circle cx="28" cy="20" fill="white" r="2.5" stroke="url(#g4a)" stroke-width="2"/><circle cx="38" cy="14" fill="white" r="2.5" stroke="url(#g4a)" stroke-width="2"/></svg></div>
            <div class="orbit-wrapper orbit-4"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g5a" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="rgba(107,140,204,0.5)"/><stop offset="50%" stop-color="rgba(122,199,184,0.5)"/><stop offset="100%" stop-color="rgba(212,120,154,0.5)"/></linearGradient></defs><circle cx="20" cy="20" fill="white" r="12" stroke="url(#g5a)" stroke-width="2"/><line stroke="url(#g5a)" stroke-linecap="round" stroke-width="2" x1="29" y1="29" x2="40" y2="40"/></svg></div>
          </div>
          <h1 class="empty-state-title">Need help with UX research?</h1>
          <p>Select to see recommended methods.</p>
        </div>`;
      return;
    }

    const options = sampleOptions[intent] || [];
    sampleSelect.innerHTML = '<option value="">Select...</option>' +
      options.map(opt => `<option value="${opt.value}">${opt.label}</option>`).join('');
    sampleSelect.disabled = false;
    document.getElementById('sampleSelectWrapper').classList.remove('disabled');
    document.getElementById('sampleHint').textContent = '';
  });

  // ---- HINT FOR DISABLED DROPDOWN ----
  document.getElementById('sampleSelectWrapper').addEventListener('click', function(e) {
    const sampleSelect = document.getElementById('sampleSelect');
    const hint = document.getElementById('sampleHint');
    if (sampleSelect.disabled) {
      hint.textContent = 'Select a research question first';
      setTimeout(() => { hint.textContent = ''; }, 3000);
    }
  });

  // ---- UPDATE RECOMMENDATION ----
  function updateRecommendation() {
    const intent = document.getElementById('intentSelect').value;
    const sample = document.getElementById('sampleSelect').value;

    if (!intent || !sample) {
      if (!intent) {
        document.getElementById('recommendation').innerHTML = `
          <div class="empty-state">
            <div class="floating-icons">
              <div class="orbit-wrapper orbit-1"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g1b" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#6b8ccc"/><stop offset="50%" stop-color="#7ac7b8"/><stop offset="100%" stop-color="#d4789a"/></linearGradient></defs><rect fill="none" height="16" rx="3" ry="3" stroke="url(#g1b)" stroke-width="2" width="6" x="10" y="22"/><rect fill="none" height="24" rx="3" ry="3" stroke="url(#g1b)" stroke-width="2" width="6" x="21" y="14"/><rect fill="none" height="28" rx="3" ry="3" stroke="url(#g1b)" stroke-width="2" width="6" x="32" y="10"/></svg></div>
              <div class="orbit-wrapper orbit-2"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g2b" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#6b8ccc"/><stop offset="50%" stop-color="#7ac7b8"/><stop offset="100%" stop-color="#d4789a"/></linearGradient></defs><circle cx="24" cy="24" fill="none" r="16" stroke="url(#g2b)" stroke-width="2"/><line stroke="url(#g2b)" stroke-width="2" x1="24" x2="24" y1="24" y2="8"/><line stroke="url(#g2b)" stroke-width="2" x1="24" x2="38" y1="24" y2="30"/></svg></div>
              <svg class="icon-checklist" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g3b" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#6b8ccc"/><stop offset="50%" stop-color="#7ac7b8"/><stop offset="100%" stop-color="#d4789a"/></linearGradient></defs><rect fill="none" height="32" rx="4" ry="4" stroke="url(#g3b)" stroke-width="1.2" width="24" x="12" y="8"/><rect fill="none" height="4" rx="1" ry="1" stroke="url(#g3b)" stroke-width="1.2" width="4" x="16" y="16"/><rect fill="none" height="4" rx="1" ry="1" stroke="url(#g3b)" stroke-width="1.2" width="4" x="16" y="24"/><polyline fill="none" points="22,18 24,20 28,16" stroke="url(#g3b)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"/><polyline fill="none" points="22,26 24,28 28,24" stroke="url(#g3b)" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.2"/></svg>
              <div class="orbit-wrapper orbit-3"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g4b" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#6b8ccc"/><stop offset="50%" stop-color="#7ac7b8"/><stop offset="100%" stop-color="#d4789a"/></linearGradient></defs><polyline fill="none" points="8,32 18,26 28,20 38,14" stroke="url(#g4b)" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"/><circle cx="8" cy="32" fill="none" r="2.5" stroke="url(#g4b)" stroke-width="2"/><circle cx="18" cy="26" fill="none" r="2.5" stroke="url(#g4b)" stroke-width="2"/><circle cx="28" cy="20" fill="none" r="2.5" stroke="url(#g4b)" stroke-width="2"/><circle cx="38" cy="14" fill="none" r="2.5" stroke="url(#g4b)" stroke-width="2"/></svg></div>
              <div class="orbit-wrapper orbit-4"><svg viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg"><defs><linearGradient id="g5b" x1="0%" y1="0%" x2="100%" y2="100%"><stop offset="0%" stop-color="#6b8ccc"/><stop offset="50%" stop-color="#7ac7b8"/><stop offset="100%" stop-color="#d4789a"/></linearGradient></defs><circle cx="20" cy="20" fill="none" r="12" stroke="url(#g5b)" stroke-width="2"/><line stroke="url(#g5b)" stroke-linecap="round" stroke-width="2" x1="29" y1="29" x2="40" y2="40"/></svg></div>
            </div>
            <h1 class="empty-state-title">Need help with UX research?</h1>
            <p>Select what you need to learn to see recommended methods.</p>
          </div>`;
      }
      return;
    }

    const scenario = (scenarios[intent] || {})[sample];
    if (!scenario) return;

    renderRecommendation(scenario);
  }

  // ---- WRAP GLOSSARY TERMS ----
  function wrapTerms(text, wrappedKeys = null) {
    // If no wrappedKeys provided, create a local one (for standalone calls)
    const trackingSet = wrappedKeys || new Set();

    const termPatterns = [
      // Statistical concepts
      { pattern: /\bA\/B test(s|ing)?\b/gi, key: 'a-b-test' },
      { pattern: /\bp-value(s)?\b/gi, key: 'p-value' },
      { pattern: /\bbinomial test(s)?\b/gi, key: 'binomial-test' },
      { pattern: /\bconfidence interval(s)?\b/gi, key: 'confidence-interval' },
      { pattern: /\beffect size(s)?\b/gi, key: 'effect-size' },
      { pattern: /\bminimum detectable effect\b/gi, key: 'mde' },
      { pattern: /\bfalse positive(s| rate)?\b/gi, key: 'false-positive' },
      { pattern: /\bstatistical(ly)? significan(t|ce)\b/gi, key: 'statistical-significance' },
      { pattern: /\bsample size(s)?\b/gi, key: 'sample-size' },
      // IA & organization methods
      { pattern: /\b(open |closed )?card sort(s|ing)?\b/gi, key: 'card-sort' },
      { pattern: /\btree test(s|ing|ed)?\b/gi, key: 'tree-test' },
      { pattern: /\b(your |the )?IA\b/g, key: 'ia' },
      { pattern: /\bmental model(s)?\b/gi, key: 'mental-model' },
      // Diagnostic & discovery methods
      { pattern: /\bsession replay(s)?\b/gi, key: 'session-replay' },
      { pattern: /\bheuristic evaluation(s)?\b/gi, key: 'heuristic-evaluation' },
      { pattern: /\bcontextual inquir(y|ies)\b/gi, key: 'contextual-inquiry' },
      { pattern: /\bfield stud(y|ies)\b/gi, key: 'field-study' },
      { pattern: /\bjourney map(s|ping)?\b/gi, key: 'journey-map' },
      { pattern: /\bdiary stud(y|ies)\b/gi, key: 'diary-study' },
      { pattern: /\bfocus group(s)?\b/gi, key: 'focus-group' },
      { pattern: /\bpersona(s)?\b/gi, key: 'persona' },
      // Testing methods
      { pattern: /\busability test(s|ing)?\b/gi, key: 'usability-test' },
      { pattern: /\bfirst[- ]click test(s|ing)?\b/gi, key: 'first-click' },
      { pattern: /\b5[- ]second test(s|ing)?\b/gi, key: 'five-second' },
      // Frameworks
      { pattern: /\bjobs[- ]to[- ]be[- ]done\b/gi, key: 'jobs-to-be-done' },
      { pattern: /\bmaxdiff( survey)?\b/gi, key: 'maxdiff' },
      // Research practices
      { pattern: /\brandomize(d|s)?\b/gi, key: 'randomize' },
      { pattern: /\brepresentative\b/gi, key: 'representative' }
    ];

    // Use placeholders to avoid nested replacements
    // Only wrap first occurrence of each term
    const replacements = [];
    let result = text;

    for (const { pattern, key } of termPatterns) {
      if (trackingSet.has(key)) continue; // Skip if already wrapped this term

      const match = result.match(pattern);
      if (match) {
        const g = glossary[key];
        if (!g) continue;
        const placeholder = `__TERM_${replacements.length}__`;
        replacements.push(`<span class="term" tabindex="0">${match[0]}<span class="tooltip">${g.def}<span class="tooltip-link" onclick="event.stopPropagation(); openGlossary();">See all definitions →</span></span></span>`);
        result = result.replace(match[0], placeholder);
        trackingSet.add(key);
      }
    }

    // Replace placeholders with actual HTML
    replacements.forEach((html, i) => {
      result = result.replace(`__TERM_${i}__`, html);
    });

    return result;
  }

  // ---- RENDER RECOMMENDATION ----
  function renderRecommendation(scenario) {
    const badgeClass = {
      'do-this': 'green',
      'directional': 'amber',
      'ab': 'blue'
    }[scenario.badgeClass] || 'blue';

    // Shared set to track wrapped terms across all sections
    const wrappedTerms = new Set();

    // Build steps HTML (with term wrapping)
    // Prepend prerequisite step for all scenarios
    const prerequisiteStep = "<strong>Before you start:</strong> Ensure all participants have the same conditions, timing, context, and are representative of your userbase.";
    const allSteps = [prerequisiteStep, ...(scenario.steps || [])];
    const stepsHtml = allSteps.map(step => `<li>${wrapTerms(step, wrappedTerms)}</li>`).join('');

    // Build warning HTML (with term wrapping)
    const mistakes = Array.isArray(scenario.mistake) ? scenario.mistake : (scenario.mistake ? [scenario.mistake] : []);
    let warningHtml = '';
    if (mistakes.length > 0) {
      const warningText = mistakes.map(m => {
        let text = m.replace(/<strong>Avoid:<\/strong>\s*/i, '');
        text = text.replace(/<strong>Don't run this if:<\/strong>\s*/i, '');
        text = text.replace(/<strong>[^<]+<\/strong>\s*/i, '');
        return text;
      }).join(' ');
      warningHtml = `<div class="warning-box"><p><strong>Avoid:</strong> ${wrapTerms(warningText, wrappedTerms)}</p></div>`;
    }

    // Build quote HTML
    const presents = Array.isArray(scenario.present) ? scenario.present : (scenario.present ? [scenario.present] : []);
    let quoteHtml = '';
    if (presents.length > 0) {
      quoteHtml = `
        <div class="quote-box">
          <div class="quote-label">How to present this</div>
          <div class="quote-text">${presents[0]}</div>
        </div>
      `;
    }

    // Build metrics HTML
    let metricsHtml = '';
    if (scenario.howToMeasure) {
      const m = scenario.howToMeasure;

      // Build steps
      const stepsContent = (m.steps || []).map(step => `
        <div class="metric-step">
          <div class="metric-step-title">${step.title}</div>
          <div class="metric-step-desc">${step.desc}</div>
          ${step.example ? `<div class="metric-step-example">${step.example}</div>` : ''}
          ${step.formula ? `<div class="metric-step-formula">${step.formula}</div>` : ''}
          ${step.note ? `<div class="metric-step-note">${step.note}</div>` : ''}
        </div>
      `).join('');

      // Build table
      let tableContent = '';
      if (m.table) {
        const col1Header = m.table.col1 || 'Sample';
        const col2Header = m.table.col2 || 'Threshold';
        const rows = m.table.rows.map(r => `
          <tr><td>${r.users}</td><td>${r.need}</td></tr>
        `).join('');
        tableContent = `
          <div class="metrics-table-title">${m.table.title}</div>
          <table class="metrics-table">
            <thead><tr><th>${col1Header}</th><th>${col2Header}</th></tr></thead>
            <tbody>${rows}</tbody>
          </table>
        `;
      }

      metricsHtml = `
        <div class="metrics-box">
          <div class="metrics-title">How to measure</div>
          ${stepsContent}
          ${tableContent}
        </div>
      `;
    }

    // Build structure HTML (for qualitative methods)
    let structureHtml = '';
    if (scenario.howToStructure) {
      const s = scenario.howToStructure;

      // Build steps
      const structureSteps = (s.steps || []).map(step => `
        <div class="metric-step">
          <div class="metric-step-title">${step.title}</div>
          ${step.desc ? `<div class="metric-step-desc">${step.desc}</div>` : ''}
          ${step.example ? `<div class="metric-step-example">${step.example}</div>` : ''}
        </div>
      `).join('');

      structureHtml = `
        <div class="metrics-box">
          <div class="metrics-title">How to structure</div>
          ${s.intro ? `<div class="structure-intro">${s.intro}</div>` : ''}
          ${structureSteps}
        </div>
      `;
    }

    // Render (with term wrapping on method and description)
    document.getElementById('recommendation').innerHTML = `
      <div class="rec-card">
        <div class="rec-header">
          <span class="rec-badge ${badgeClass}">${scenario.badgeText || ''}</span>
          <span class="rec-method">${wrapTerms(scenario.method || '', wrappedTerms)}</span>
        </div>
        <p class="rec-desc">${wrapTerms(scenario.rec || '', wrappedTerms)}</p>

        <div class="steps-title">Steps</div>
        <ul class="steps">${stepsHtml}</ul>

        ${warningHtml}
        ${metricsHtml}
        ${structureHtml}
        ${quoteHtml}
      </div>
    `;
  }

  /* ---------------  HAMBURGER MENU  --------------- */
  const hamburger = document.querySelector('.hamburger');
  const navMenu = document.getElementById('navMenu');

  hamburger.addEventListener('click', () => {
    hamburger.classList.toggle('active');
    navMenu.classList.toggle('active');
    hamburger.setAttribute('aria-expanded',
      hamburger.getAttribute('aria-expanded') === 'true' ? 'false' : 'true'
    );
  });

  // Close menu when clicking on a link
  navMenu.querySelectorAll('a').forEach(link => {
    link.addEventListener('click', () => {
      hamburger.classList.remove('active');
      navMenu.classList.remove('active');
      hamburger.setAttribute('aria-expanded', 'false');
    });
  });

  // Close menu when clicking outside
  document.addEventListener('click', (e) => {
    if (!hamburger.contains(e.target) && !navMenu.contains(e.target)) {
      hamburger.classList.remove('active');
      navMenu.classList.remove('active');
      hamburger.setAttribute('aria-expanded', 'false');
    }
  });
</script>
</body>
</html>